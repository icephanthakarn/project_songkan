<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>My App</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    .sort-dropdown-wrapper {
      position: relative;
      display: inline-block;
    }

    .sort-dropdown-menu {
      display: none;
      position: absolute;
      top: 100%;
      right: 0;
      background-color: #fff;
      border: 1px solid #ea5c0d;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      min-width: 150px;
      overflow: hidden;
    }

    .sort-dropdown-menu div {
      padding: 10px 15px;
      cursor: pointer;
      color: #ea5c0d;
      font-weight: bold;
    }

    .sort-dropdown-menu div:hover {
      background-color: #fff4ee;
    }

    .rotate {
      transform: rotate(180deg);
      transition: transform 0.2s ease;
    }
  </style>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar">
    <div class="container">
      <a href="{{ url_for('index') }}" class="brand">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>

      <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏¥‡∏á‡∏Å‡πå Admin ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô -->
      {% if user_is_admin %}
      <div class="dropdown-menu">
        <a href="{{ url_for('profile') }}"><i class="fa-solid fa-user"></i> Profile</a>
        <a href="{{ url_for('admin_page') }}"><i class="fa fa-folder-open"></i> Project List</a>
        <a href="{{ url_for('logout') }}"><i class="fa-solid fa-right-from-bracket"></i> Log out</a>
      </div>
      {% endif %}

      {% if user_logged_in %}
      <div class="profile-wrapper">
        <div class="profile-btn">
          <div class="avatar-circle" style="background-color: {{ avatar_color }}">
            {{ first_letter }}
          </div>
          <span class="student-id">{{ student_id }}</span>
          <i class="fa-solid fa-chevron-down arrow"></i>
        </div>
        <div class="dropdown-menu">
          <a href="{{ url_for('profile') }}"><i class="fa-solid fa-user"></i> Profile</a>
          <a href="{{ url_for('admin_page') }}"><i class="fa fa-folder-open"></i> Project List</a>
          <a href="{{ url_for('logout') }}"><i class="fa-solid fa-right-from-bracket"></i> Log out</a>
        </div>
      </div>
      {% else %}
      <a href="{{ url_for('login') }}" class="login-btn">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a>
      {% endif %}
    </div>
  </nav>

  <!-- ‚úÖ ‡∏Ñ‡∏£‡∏≠‡∏ö container -->
  <div class="container">
    <div class="profile-page">
      <div class="profile-card">
        <div class="avatar-circle big" style="background-color: {{ avatar_color }};">
          {{ first_letter }}
        </div>
        <div class="info">
          <p>‡∏ä‡∏∑‡πà‡∏≠ - ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• : <span class="highlight">{{ user_name }}</span></p>
          <p>‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ : <span class="highlight">{{ student_id }}</span></p>
          <p>‡∏Ñ‡∏ì‡∏∞ : <span class="highlight">{{ faculty }}</span></p>
          <p>‡∏†‡∏≤‡∏Ñ‡∏ß‡∏¥‡∏ä‡∏≤ : <span class="highlight">{{ department }}</span></p>
        </div>
      </div>

      <div class="upload-section">
        <h3>YOUR WORK</h3>

        {% if user_role == 'admin' %}
                <!-- ‚úÖ ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏ü‡∏•‡πå ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö admin -->
                <div class="upload-box">
                  <form method="POST" action="{{ url_for('upload_project') }}" enctype="multipart/form-data" id="upload-form">
                    <input type="file" name="pdf_file" id="real-file" hidden onchange="document.getElementById('upload-form').submit();">
                    <span class="upload-link" onclick="document.getElementById('real-file').click();">
                      CLICK HERE TO UPLOAD ANOTHER FILE
                    </span>
                  </form>
                </div>
        {% for project in admin_projects %}
        <div class="project-card">
          {% if project.thumbnail_path %}
            <div class="thumbnail">
              <img src="{{ url_for('static', filename=project.thumbnail_path) }}" alt="PDF Thumbnail">
            </div>
          {% endif %}
          <div class="project-info">
            <h3 style="font-weight: bold; color:#444444d8;">{{ project.title_th }}</h3>
            <!--<p> {{ project.title_th }}</p>-->
            <p>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ : <span class="highlight">{{ project.academic_year }}</span></p>
            <p>‡∏Ñ‡∏ì‡∏∞ : <span class="highlight">{{ project.faculty }}</span></p>
            <p>‡∏™‡∏≤‡∏Ç‡∏≤ : <span class="highlight">{{ project.department }}</span></p>
            <div class="action-buttons">
              <a href="{{ url_for('edit_project', project_id=project.id) }}" class="edit-btn">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</a>
              <form method="POST" action="{{ url_for('delete_project', project_id=project.id) }}">
                <button type="submit" class="delete-btn">‡∏•‡∏ö</button>
              </form>
            </div>
          </div>
        </div>
        {% endfor %}
    

    
      {% else %}
        {% if user_project %}
        <div class="project-card">
          {% if user_project.thumbnail_path %}
            <div class="thumbnail">
              <img src="{{ url_for('static', filename=user_project.thumbnail_path) }}" alt="PDF Thumbnail">
            </div>
          {% endif %}
          <div class="project-info">
            <h3>{{ user_project.title }}</h3>
            <p>(‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© {{ user_project.alt_title }})</p>
            <p>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ : <span class="highlight">{{ user_project.year }}</span></p>
            <p>‡∏Ñ‡∏ì‡∏∞ : <span class="highlight">{{ user_project.faculty }}</span></p>
            <p>‡∏™‡∏≤‡∏Ç‡∏≤ : <span class="highlight">{{ user_project.department }}</span></p>
            <div class="action-buttons">
              <a href="{{ url_for('project_detail', project_id=user_project.id) }}" class="detail-btn">‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</a>
              <form method="POST" action="{{ url_for('delete_project', project_id=user_project.id) }}">
                <button type="submit" class="delete-btn">‡∏•‡∏ö üóëÔ∏è</button>
              </form>
            </div>
          </div>
        </div>
        {% else %}
        <!-- ‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡πÅ‡∏Ñ‡πà‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß -->
        <div class="upload-box">
          <form method="POST" action="{{ url_for('upload_project') }}" enctype="multipart/form-data" id="upload-form">
            <input type="file" name="pdf_file" id="real-file" hidden onchange="document.getElementById('upload-form').submit();">
            <span class="upload-link" onclick="document.getElementById('real-file').click();">
              CLICK HERE TO UPLOAD YOUR PROJECT
            </span>
          </form>
        </div>
        {% endif %}
      {% endif %}
    </div>
    </div>
  </div>
</body>


